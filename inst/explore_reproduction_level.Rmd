---
title: "The effect of the reproduction level"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
# Varying the reproduction level
Figures 1 to 5 show how the scenarios in our paper are affected
by the choice of reproduction level. Here the reproduction level is set
equal for all species to either 0.25, 0.45 or 0.65. 

# What shall we plot?
We have to decide whether we want to plot biomass or yield and whether we
want percentage change or absolute values. Figures 6 to 10 show what the various plots
will look like with a reproduction level of 0.65.
```{r}
getwd()
```




```{r include=FALSE}
plotYieldChange <- function(params, base, t_max = 50,
                            repro_levels = c(0.65, 0.45, 0.25)) {
    base <- base[base$Year <= t_max, ]
    params <- setBevertonHolt(params, reproduction_level = repro_levels[1])
    sim <- project(params, t_max = t_max, progress_bar = FALSE)
    df_high <- plotYield(sim, species = commercial, return_data = TRUE)
    df_high$Change <- (df_high$Yield / base$Yield - 1) * 100
    df_high$repro_level <- repro_levels[1]
    
    params <- setBevertonHolt(params, reproduction_level = repro_levels[2])
    sim <- project(params, t_max = t_max, progress_bar = FALSE)
    df_med <- plotYield(sim, species = commercial, return_data = TRUE)
    df_med$Change <- (df_med$Yield / base$Yield - 1) * 100
    df_med$repro_level <- repro_levels[2]
    
    params <- setBevertonHolt(params, reproduction_level = repro_levels[3])
    sim <- project(params, t_max = t_max, progress_bar = FALSE)
    df_low <- plotYield(sim, species = commercial, return_data = TRUE)
    df_low$Change <- (df_low$Yield / base$Yield - 1) * 100
    df_low$repro_level <- repro_levels[3]
    
    df <- rbind(df_low, df_med, df_high)
    ggplot(data = df) +
        geom_line(aes(x = Year, y = Change, 
                      linetype = Species, color = Species)) +
        ylab("Yield change in %") +
        facet_wrap("repro_level") +
        geom_hline(yintercept = 0) +
        theme_classic()
}
```

